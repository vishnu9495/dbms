<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <p>CREATE TABLE ACTOR ( ACT_ID INT, ACT_NAME VARCHAR(20), ACT_GENDER CHAR(1), PRIMARY KEY (ACT_ID) );</p>
    <p>CREATE TABLE DIRECTOR ( DIR_ID INT, DIR_NAME VARCHAR(20), DIR_PHONE BIGINT, PRIMARY KEY (DIR_ID) );</p>
    <p>CREATE TABLE MOVIES ( MOV_ID INT, MOV_TITLE VARCHAR(25), MOV_YEAR INT, MOV_LANG VARCHAR(12), DIR_ID INT, PRIMARY KEY (MOV_ID), FOREIGN KEY (DIR_ID) REFERENCES DIRECTOR(DIR_ID) );</p>
    <p>CREATE TABLE MOVIE_CAST ( ACT_ID INT, MOV_ID INT, ROLE VARCHAR(10), PRIMARY KEY (ACT_ID, MOV_ID), FOREIGN KEY (ACT_ID) REFERENCES ACTOR(ACT_ID), FOREIGN KEY (MOV_ID) REFERENCES MOVIES(MOV_ID) );</p>
    <p>CREATE TABLE RATING ( MOV_ID INT, REV_STARS INT, PRIMARY KEY (MOV_ID), FOREIGN KEY (MOV_ID) REFERENCES MOVIES(MOV_ID) );</p>

    <p>INSERT INTO ACTOR VALUES (301, 'ANUSHKA', 'F'),
        (302, 'PRABHAS', 'M'),
        (303, 'PUNITH', 'M'),
        (304, 'JERMY', 'M');</p>

    <p>INSERT INTO DIRECTOR VALUES (60, 'RAJAMOULI', 8751611001),
        (61, 'HITCHCOCK', 7766138911),
        (62, 'FARAN', 9986776531);</p>

    <p>INSERT INTO DIRECTOR VALUES (63, 'STEVEN SPIELBERG', 8989776530),
        (1001, 'BAHUBALI-2', 2017, 'TELUGU', 60),
        (1002, 'BAHUBALI-1', 2015, 'TELUGU', 60),
        (1003, 'AKASH', 2008, 'KANNADA', 61),
        (1004, 'WAR HORSE', 2011, 'ENGLISH', 63);</p>

    <p>INSERT INTO MOVIE_CAST VALUES (301, 1002, 'HEROINE'),
        (301, 1001, 'HEROINE'),
        (303, 1003, 'HERO'),
        (303, 1002, 'GUEST'),
        (304, 1004, 'HERO');</p>

    <p>INSERT INTO RATING VALUES (1001, 4),
        (1002, 2),
        (1003, 5),
        (1004, 4);</p>

    <p>SELECT MOV_TITLE FROM MOVIES WHERE DIR_ID IN ( SELECT DIR_ID FROM DIRECTOR WHERE DIR_NAME = 'HITCHCOCK' );</p>
    <p>SELECT MOV_TITLE FROM MOVIES M JOIN MOVIE_CAST MV ON M.MOV_ID = MV.MOV_ID WHERE ACT_ID IN 
        ( SELECT ACT_ID FROM MOVIE_CAST GROUP BY ACT_ID HAVING COUNT(ACT_ID) &gt; 1 ) 
        GROUP BY MOV_TITLE HAVING COUNT(*) &gt; 1;</p>
    <p>SELECT ACT_NAME, MOV_TITLE, MOV_YEAR FROM ACTOR A JOIN MOVIE_CAST C ON A.ACT_ID = C.ACT_ID 
        JOIN MOVIES M ON C.MOV_ID = M.MOV_ID WHERE M.MOV_YEAR NOT BETWEEN 2000 AND 2015;</p>
    <p>SELECT A.ACT_NAME, C.MOV_TITLE, C.MOV_YEAR FROM ACTOR A JOIN MOVIE_CAST B ON A.ACT_ID = B.ACT_ID 
        JOIN MOVIES C ON B.MOV_ID = C.MOV_ID WHERE C.MOV_YEAR NOT BETWEEN 2000 AND 2015;</p>
    <p>SELECT MOV_TITLE, MAX(REV_STARS) FROM MOVIES INNER JOIN RATING USING (MOV_ID) 
        GROUP BY MOV_TITLE HAVING MAX(REV_STARS) &gt; 0 ORDER BY MOV_TITLE;</p>
    <p>UPDATE RATING SET REV_STARS = 5 WHERE MOV_ID IN ( SELECT MOV_ID FROM MOVIES WHERE DIR_ID IN 
        ( SELECT DIR_ID FROM DIRECTOR WHERE DIR_NAME = 'STEVEN SPIELBERG' ) );</p>
</body>
</html>
