<!DOCTYPE html>
<html>
<head>
    <title>Database Queries</title>
</head>
<body>
    <p>CREATE TABLE DEPARTMENT (
        DNO VARCHAR(20) PRIMARY KEY,
        DNAME VARCHAR(20),
        MGRSTARTDATE DATE
    );</p>
    <p>CREATE TABLE EMPLOYEE (
        SSN VARCHAR(20) PRIMARY KEY,
        FNAME VARCHAR(20),
        LNAME VARCHAR(20),
        ADDRESS VARCHAR(20),
        SEX CHAR(1),
        SALARY INTEGER,
        SUPERSSN VARCHAR(20),
        DNO VARCHAR(20),
        FOREIGN KEY (SUPERSSN) REFERENCES EMPLOYEE (SSN),
        FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO)
    );</p>
    <p>ALTER TABLE DEPARTMENT
        ADD MGRSSN VARCHAR(20),
        ADD FOREIGN KEY (MGRSSN) REFERENCES EMPLOYEE (SSN);
    </p>
    <p>CREATE TABLE DLOCATION (
        DLOC VARCHAR(20),
        DNO VARCHAR(20),
        PRIMARY KEY (DNO, DLOC),
        FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO)
    );</p>
    <p>CREATE TABLE PROJECT (
        PNO INTEGER PRIMARY KEY,
        PNAME VARCHAR(20),
        PLOCATION VARCHAR(20),
        DNO VARCHAR(20),
        FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO)
    );</p>
    <p>CREATE TABLE WORKS_ON (
        HOURS INT,
        SSN VARCHAR(20),
        PNO INTEGER,
        PRIMARY KEY (SSN, PNO),
        FOREIGN KEY (SSN) REFERENCES EMPLOYEE (SSN),
        FOREIGN KEY (PNO) REFERENCES PROJECT (PNO)
    );</p>
    
    <h2>Insert Statements</h2>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSECE01', 'JOHN', 'SCOTT', 'BANGALORE', 'M', 450000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSCSE01', 'JAMES', 'SMITH', 'BANGALORE', 'M', 500000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSCSE02', 'HEARN', 'BAKER', 'BANGALORE', 'M', 700000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSCSE03', 'EDWARD', 'SCOTT', 'MYSORE', 'M', 500000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSCSE04', 'PAVAN', 'HEGDE', 'MANGALORE', 'M', 650000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSCSE05', 'GIRISH', 'MALYA', 'MYSORE', 'M', 450000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSCSE06', 'NEHA', 'SN', 'BANGALORE', 'F', 800000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSACC01', 'AHANA', 'K', 'MANGALORE', 'F', 350000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSACC02', 'SANTHOSH', 'KUMAR', 'MANGALORE', 'M', 300000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSISE01', 'VEENA', 'M', 'MYSORE', 'M', 600000);</p>
    <p>INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES ('RNSIT01', 'NAGESH', 'HR', 'BANGALORE', 'M', 500000);</p>
    
    <p>INSERT INTO DEPARTMENT VALUES ('1', 'ACCOUNTS', '2001-01-01', 'RNSACC02');</p>
    <p>INSERT INTO DEPARTMENT VALUES ('2', 'IT', '2016-08-01', 'RNSIT01');</p>
    <p>INSERT INTO DEPARTMENT VALUES ('3', 'ECE', '2008-06-01', 'RNSECE01');</p>
    <p>INSERT INTO DEPARTMENT VALUES ('4', 'ISE', '2015-08-01', 'RNSISE01');</p>
    <p>INSERT INTO DEPARTMENT VALUES ('5', 'CSE', '2002-06-01', 'RNSCSE05');</p>
    
    <p>UPDATE EMPLOYEE SET SUPERSSN=NULL, DNO='3' WHERE SSN='RNSECE01';</p>
    <p>UPDATE EMPLOYEE SET SUPERSSN='RNSCSE02', DNO='5' WHERE SSN='RNSCSE01';</p>
    <p>UPDATE EMPLOYEE SET SUPERSSN='RNSCSE03', DNO='5' WHERE SSN='RNSCSE02';</p>
    <p>UPDATE EMPLOYEE SET SUPERSSN='RNSCSE04', DNO='5' WHERE SSN='RNSCSE03';</p>
    <p>UPDATE EMPLOYEE SET DNO='5', SUPERSSN='RNSCSE05' WHERE SSN='RNSCSE04';</p>
    <p>UPDATE EMPLOYEE SET DNO='5', SUPERSSN='RNSCSE06' WHERE SSN='RNSCSE05';</p>
    <p>UPDATE EMPLOYEE SET DNO='5', SUPERSSN=NULL WHERE SSN='RNSCSE06';</p>
    <p>UPDATE EMPLOYEE SET DNO='1', SUPERSSN='RNSACC02' WHERE SSN='RNSACC01';</p>
    <p>UPDATE EMPLOYEE SET DNO='1', SUPERSSN=NULL WHERE SSN='RNSACC02';</p>
    <p>UPDATE EMPLOYEE SET DNO='4', SUPERSSN=NULL WHERE SSN='RNSISE01';</p>
    <p>UPDATE EMPLOYEE SET DNO='2', SUPERSSN=NULL WHERE SSN='RNSIT01';</p>
    
    <p>INSERT INTO DLOCATION VALUES ('BANGALORE', '1');</p>
    <p>INSERT INTO DLOCATION VALUES ('BANGALORE', '2');</p>
    <p>INSERT INTO DLOCATION VALUES ('BANGALORE', '3');</p>
    <p>INSERT INTO DLOCATION VALUES ('MANGALORE', '4');</p>
    <p>INSERT INTO DLOCATION VALUES ('MANGALORE', '5');</p>
    
    <p>INSERT INTO PROJECT VALUES (100, 'IOT', 'BANGALORE', '5');</p>
    <p>INSERT INTO PROJECT VALUES (101, 'CLOUD', 'BANGALORE', '5');</p>
    <p>INSERT INTO PROJECT VALUES (102, 'BIGDATA', 'BANGALORE', '5');</p>
    <p>INSERT INTO PROJECT VALUES (103, 'SENSORS', 'BANGALORE', '3');</p>
    <p>INSERT INTO PROJECT VALUES (104, 'BANK MANAGEMENT', 'BANGALORE', '1');</p>
    <p>INSERT INTO PROJECT VALUES (105, 'SALARY MANAGEMENT', 'BANGALORE', '1');</p>
    <p>INSERT INTO PROJECT VALUES (106, 'OPENSTACK', 'BANGALORE', '4');</p>
    <p>INSERT INTO PROJECT VALUES (107, 'SMARTCITY', 'BANGALORE', '2');</p>
    
    <p>INSERT INTO WORKS_ON VALUES (4, 'RNSCSE01', 100);</p>
    <p>INSERT INTO WORKS_ON VALUES (6, 'RNSCSE01', 101);</p>
    <p>INSERT INTO WORKS_ON VALUES (8, 'RNSCSE01', 102);</p>
    <p>INSERT INTO WORKS_ON VALUES (10, 'RNSCSE02', 100);</p>
    <p>INSERT INTO WORKS_ON VALUES (3, 'RNSCSE04', 100);</p>
    <p>INSERT INTO WORKS_ON VALUES (4, 'RNSCSE05', 101);</p>
    <p>INSERT INTO WORKS_ON VALUES (5, 'RNSCSE06', 102);</p>
    <p>INSERT INTO WORKS_ON VALUES (6, 'RNSCSE03', 102);</p>
    <p>INSERT INTO WORKS_ON VALUES (7, 'RNSECE01', 103);</p>
    <p>INSERT INTO WORKS_ON VALUES (5, 'RNSACC01', 104);</p>
    <p>INSERT INTO WORKS_ON VALUES (6, 'RNSACC02', 105);</p>
    <p>INSERT INTO WORKS_ON VALUES (4, 'RNSISE01', 106);</p>
    <p>INSERT INTO WORKS_ON VALUES (10, 'RNSIT01', 107);</p>
    
    <h2>Select Statements</h2>
    <p>SELECT * FROM EMPLOYEE;</p>
    <p>SELECT * FROM DEPARTMENT;</p>
    <p>SELECT * FROM DLOCATION;</p>
    <p>SELECT * FROM PROJECT;</p>
    <p>SELECT * FROM WORKS_ON;</p>
    
    <h2>Queries</h2>
    <h3>Query 1</h3>
    <p>(SELECT DISTINCT P.PNO
        FROM PROJECT P, DEPARTMENT D, EMPLOYEE E
        WHERE E.DNO = D.DNO
        AND D.MGRSSN = E.SSN
        AND E.LNAME = 'SCOTT')
    UNION
    (SELECT DISTINCT P1.PNO
        FROM PROJECT P1, WORKS_ON W, EMPLOYEE E1
        WHERE P1.PNO = W.PNO
        AND E1.SSN = W.SSN
        AND E1.LNAME = 'SCOTT');</p>
    
    <h3>Query 2</h3>
    <p>SELECT E.FNAME, E.LNAME, 1.1 * E.SALARY AS INCR_SAL
        FROM EMPLOYEE E, WORKS_ON W, PROJECT P
        WHERE E.SSN = W.SSN
        AND W.PNO = P.PNO
        AND P.PNAME = 'IOT';</p>
    
    <h3>Query 3</h3>
    <p>SELECT SUM(E.SALARY), MAX(E.SALARY), MIN(E.SALARY), AVG(E.SALARY)
        FROM EMPLOYEE E, DEPARTMENT D
        WHERE E.DNO = D.DNO
        AND D.DNAME = 'ACCOUNTS';</p>
    
    <h3>Query 4</h3>
    <p>SELECT E.FNAME, E.LNAME
        FROM EMPLOYEE E
        WHERE NOT EXISTS (
        (SELECT PNO FROM PROJECT WHERE DNO = '5')
        MINUS
        (SELECT PNO FROM WORKS_ON WHERE E.SSN = SSN)
    );</p>
    
    <h3>Query 5</h3>
    <p>SELECT D.DNO, COUNT(*)
        FROM DEPARTMENT D, EMPLOYEE E
        WHERE D.DNO = E.DNO
        AND E.SALARY > 600000
        AND D.DNO IN (
        SELECT E1.DNO
        FROM EMPLOYEE E1
        GROUP BY E1.DNO
        HAVING COUNT(*) > 5
    )
    GROUP BY D.DNO;</p>
</body>
</html>
