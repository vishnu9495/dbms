<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <p>CREATE TABLE PUBLISHER (
 NAME VARCHAR(20) PRIMARY KEY,
 PHONE INT,
 ADDRESS VARCHAR(20)
);</p>

<p>CREATE TABLE BOOK (
 BOOK_ID INT PRIMARY KEY,
 TITLE VARCHAR(20),
 PUB_YEAR VARCHAR(20),
 PUBLISHER_NAME VARCHAR(20),
 CONSTRAINT FK_PUBLISHER_NAME FOREIGN KEY (PUBLISHER_NAME) REFERENCES
PUBLISHER(NAME) ON DELETE CASCADE
);</p>

<p>CREATE TABLE BOOK_AUTHORS (
 AUTHOR_NAME VARCHAR(20),
 BOOK_ID INT,
 PRIMARY KEY (BOOK_ID, AUTHOR_NAME),
 CONSTRAINT FK_BOOK_ID FOREIGN KEY (BOOK_ID) REFERENCES BOOK(BOOK_ID) ON
DELETE CASCADE
);</p>

<p>CREATE TABLE LIBRARY_BRANCH (
 BRANCH_ID INT PRIMARY KEY,
 BRANCH_NAME VARCHAR(50),
 ADDRESS VARCHAR(50)
);</p>

<p>CREATE TABLE BOOK_COPIES (
 NO_OF_COPIES INT,
 BOOK_ID INT,
 BRANCH_ID INT,
 PRIMARY KEY (BOOK_ID, BRANCH_ID),
 CONSTRAINT FK_BOOK_COPIES_BOOK_ID FOREIGN KEY (BOOK_ID) REFERENCES
BOOK(BOOK_ID) ON DELETE CASCADE,
 CONSTRAINT FK_BOOK_COPIES_BRANCH_ID FOREIGN KEY (BRANCH_ID) REFERENCES
LIBRARY_BRANCH(BRANCH_ID) ON DELETE CASCADE
);</p>

<p>CREATE TABLE CARD (
 CARD_NO INT PRIMARY KEY
);</p>

<p>CREATE TABLE BOOK_LENDING (
 DATE_OUT DATE,
 DUE_DATE DATE,
 BOOK_ID INT,
 BRANCH_ID INT,
 CARD_NO INT,
 PRIMARY KEY (BOOK_ID, BRANCH_ID, CARD_NO),
 CONSTRAINT FK_LENDING_BOOK_ID FOREIGN KEY (BOOK_ID) REFERENCES BOOK(BOOK_ID)
ON DELETE CASCADE,
 CONSTRAINT FK_LENDING_BRANCH_ID FOREIGN KEY (BRANCH_ID) REFERENCES
LIBRARY_BRANCH(BRANCH_ID) ON DELETE CASCADE
);</p>
<p>INSERT INTO PUBLISHER VALUES 
('MCGRAW-HILL', 9989076587, 'BANGALORE'),
('PEARSON', 9889076565, 'NEWDELHI'),
('RANDOM HOUSE', 7455679345, 'HYDERABAD'),
('HACHETTE LIVRE', 8970862340, 'CHENNAI'),
('GRUPO PLANETA', 7756120238, 'BANGALORE');</p>

<p>INSERT INTO BOOK VALUES 
(1, 'DBMS', 'JAN-2017', 'MCGRAW-HILL'),
(2, 'ADBMS', 'JUN-2016', 'MCGRAW-HILL'),
(3, 'CN', 'SEP-2016', 'PEARSON'),
(4, 'CG', 'SEP-2015', 'GRUPO PLANETA'),
(5, 'OS', 'MAY-2016', 'PEARSON');</p>

<p>INSERT INTO BOOK_AUTHORS VALUES 
('NAVATHE', 1),
('NAVATHE', 2),
('TANENBAUM', 3),
('EDWARD ANGEL', 4),
('GALVIN', 5);</p>

<p>INSERT INTO LIBRARY_BRANCH VALUES 
(10, 'RR NAGAR', 'BANGALORE'),
(11, 'RNSIT', 'BANGALORE'),
(12, 'RAJAJI NAGAR', 'BANGALORE'),
(13, 'NITTE', 'MANGALORE'),
(14, 'MANIPAL', 'UDUPI');</p>

<p>INSERT INTO BOOK_COPIES VALUES 
(10, 1, 10),
(5, 1, 11),
(2, 2, 12),
(5, 2, 13),
(7, 3, 14),
(1, 5, 10),
(3, 4, 11);</p>

<p>INSERT INTO CARD VALUES 
(100),
(101),
(102),
(103);</p>

<p>INSERT INTO BOOK_LENDING VALUES 
('01-JAN-17', '01-JUN-17', 1, 10, 101),
('11-JAN-17', '11-MAR-17', 3, 14, 101),
('21-FEB-17', '21-APR-17', 2, 13, 101),
('15-MAR-17', '15-JUL-17', 4, 11, 101),
('12-APR-17', '12-MAY-17', 1, 11, 104);</p>

<p>SELECT B.BOOK_ID, B.TITLE, B.PUBLISHER_NAME, A.AUTHOR_NAME, C.NO_OF_COPIES, L.BRANCH_ID
FROM BOOK B
JOIN BOOK_AUTHORS A ON B.BOOK_ID = A.BOOK_ID
JOIN BOOK_COPIES C ON B.BOOK_ID = C.BOOK_ID
JOIN LIBRARY_BRANCH L ON L.BRANCH_ID = C.BRANCH_ID;</p>

<p>SELECT CARD_NO
FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN '01-JAN-2017' AND '01-JUL-2017'
GROUP BY CARD_NO
HAVING COUNT(*) > 3;</p>

<p>CREATE VIEW V_PUBLICATION AS 
SELECT PUB_YEAR
FROM BOOK;</p>

<p>CREATE VIEW V_BOOKS AS
SELECT B.BOOK_ID, B.TITLE, C.NO_OF_COPIES
FROM BOOK B
JOIN BOOK_COPIES C ON B.BOOK_ID = C.BOOK_ID
JOIN LIBRARY_BRANCH L ON C.BRANCH_ID = L.BRANCH_ID;</p>

</body>
</html>